<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weekly Staff Roster Editor</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Custom styles */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Style for the scrollbar to be more subtle */
        .roster-container::-webkit-scrollbar {
            height: 8px;
        }
        .roster-container::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        .roster-container::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }
        .roster-container::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
        /* Class for the element being dragged */
        .dragging {
            opacity: 0.5;
            transform: scale(0.95);
        }
        /* Class for highlighting a valid drop zone */
        .drag-over {
            outline: 2px dashed #3b82f6;
            outline-offset: -2px;
            background-color: rgba(255, 255, 255, 0.2);
        }
        /* Grab cursor for draggable items */
        [draggable="true"] {
            cursor: grab;
        }
        [draggable="true"]:active {
            cursor: grabbing;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen p-4 sm:p-6 lg:p-8">

    <div class="w-full max-w-screen-2xl mx-auto">
        <div class="p-6 bg-white rounded-xl shadow-lg mb-8">
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
                <div>
                    <h1 class="text-2xl font-bold text-gray-800">Weekly Roster Editor</h1>
                    <p id="roster-date-range" class="text-gray-500 mt-1"></p>
                </div>
                <div class="flex-shrink-0">
                    <label for="start-date-picker" class="block text-sm font-medium text-gray-700 mb-1">Start of Week</label>
                    <input type="date" id="start-date-picker" class="p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
            </div>
        </div>

        <div class="flex flex-col lg:flex-row gap-8">
            <!-- Staff Palette -->
            <aside class="lg:w-64 bg-white rounded-xl shadow-lg p-6 h-fit">
                <h2 class="text-xl font-bold text-gray-800 mb-4">Staff</h2>
                <div id="staff-palette" class="space-y-3">
                    <!-- Draggable staff names will be generated here by JavaScript -->
                </div>
            </aside>

            <!-- Roster -->
            <main class="flex-1">
                <div class="w-full bg-white rounded-xl shadow-lg overflow-hidden">
                    <div id="roster-container" class="roster-container overflow-x-auto">
                        <!-- Roster will be generated here by JavaScript -->
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script>
        // --- Data Model ---
        const staffMembers = [
            'Chrissy', 'Gemma', 'Jodie', 'Niamh', 'Julie', 'MacKenzie', 
            'India', 'Zack', 'Charlie', 'Else', 'Simon', 'Alex'
        ];

        let rosterData = {
            startDate: '2025-04-21',
            sections: [
                {
                    colorClass: 'bg-teal-500',
                    schedule: [
                        ['Chrissy', 'Chrissy', 'Chrissy', 'Chrissy', 'Gemma', 'Jodie', 'Jodie'],
                        ['Niamh', 'Gemma', 'Gemma', 'Gemma', 'Niamh', 'Niamh', 'Niamh'],
                        ['Julie', 'Julie', 'MacKenzie', 'India', 'India', 'India', 'India']
                    ]
                },
                {
                    colorClass: 'bg-orange-500',
                    schedule: [
                        ['Zack', 'Zack', 'Zack', 'Zack', 'Charlie', 'Charlie', 'Else'],
                        ['Simon', 'Simon', 'Charlie', 'Charlie', 'Alex', 'Simon', 'Simon'],
                        ['', '', '', '', '', 'Alex', 'Alex']
                    ]
                }
            ]
        };

        // --- State for Drag & Drop ---
        let draggedItem = null;

        // --- DOM Elements ---
        const staffPalette = document.getElementById('staff-palette');
        const rosterContainer = document.getElementById('roster-container');
        const rosterDateRangeEl = document.getElementById('roster-date-range');
        const datePicker = document.getElementById('start-date-picker');

        // --- Main Render Function ---
        function render() {
            // Update date displays first
            const startDate = new Date(rosterData.startDate + 'T00:00:00');
            const endDate = new Date(startDate);
            endDate.setDate(startDate.getDate() + 6);
            const dateFormatter = new Intl.DateTimeFormat('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
            rosterDateRangeEl.textContent = `${dateFormatter.format(startDate)} - ${dateFormatter.format(endDate)}`;
            datePicker.value = rosterData.startDate;

            // Clear existing content
            staffPalette.innerHTML = '';
            rosterContainer.innerHTML = '';

            // 1. Render Staff Palette
            staffMembers.forEach(name => {
                const staffEl = createDraggableName(name, 'palette', 'bg-gray-200 text-gray-800');
                staffPalette.appendChild(staffEl);
            });
            // Add a special "Remove" item
            const removeEl = createDraggableName('Remove', 'palette', 'bg-red-200 text-red-800');
            staffPalette.appendChild(removeEl);


            // 2. Render Roster
            const grid = document.createElement('div');
            grid.className = 'grid grid-cols-7 min-w-[1000px]';
            
            // Generate Header
            const headerRow = createHeader();
            grid.appendChild(headerRow);
            
            // Generate Body
            rosterData.sections.forEach((section, sectionIndex) => {
                section.schedule.forEach((row, rowIndex) => {
                    row.forEach((name, colIndex) => {
                        const cell = createDroppableCell(section, sectionIndex, rowIndex, colIndex);
                        grid.appendChild(cell);
                    });
                });
            });
            rosterContainer.appendChild(grid);
        }

        // --- Element Creation Helpers ---
        function createHeader() {
            const headerRow = document.createElement('div');
            headerRow.className = 'col-span-7 grid grid-cols-7 sticky top-0 bg-white z-10';
            const startDate = new Date(rosterData.startDate + 'T00:00:00');
            const dayFormatter = new Intl.DateTimeFormat('en-US', { weekday: 'short', day: '2-digit', month: 'short' });
            for (let i = 0; i < 7; i++) {
                const currentDate = new Date(startDate);
                currentDate.setDate(startDate.getDate() + i);
                 const parts = dayFormatter.formatToParts(currentDate);
                const weekday = parts.find(p => p.type === 'weekday').value;
                const day = parts.find(p => p.type === 'day').value;
                const month = parts.find(p => p.type === 'month').value;
                const dayCell = document.createElement('div');
                dayCell.className = 'text-center font-semibold text-gray-700 p-3 border-b-2 border-r border-gray-200';
                dayCell.textContent = `${weekday} ${day} ${month}`;
                headerRow.appendChild(dayCell);
            }
            return headerRow;
        }

        function createDraggableName(name, type, styleClasses, data = {}) {
            const el = document.createElement('div');
            el.className = `p-2 rounded-md font-medium text-center transition-all ${styleClasses}`;
            el.textContent = name;
            el.draggable = true;
            el.addEventListener('dragstart', (e) => handleDragStart(e, name, type, data));
            el.addEventListener('dragend', handleDragEnd);
            return el;
        }

        function createDroppableCell(section, sectionIndex, rowIndex, colIndex) {
            const cell = document.createElement('div');
            const name = section.schedule[rowIndex][colIndex];
            cell.className = `h-16 flex items-center justify-center p-1 border-b border-r border-white/20 transition-colors ${section.colorClass}`;
            
            cell.addEventListener('dragover', handleDragOver);
            cell.addEventListener('dragleave', handleDragLeave);
            cell.addEventListener('drop', (e) => handleDrop(e, sectionIndex, rowIndex, colIndex));

            if (name) {
                const data = { sectionIndex, rowIndex, colIndex };
                const nameEl = createDraggableName(name, 'cell', 'text-white w-full h-full flex items-center justify-center', data);
                cell.appendChild(nameEl);
            }
            return cell;
        }

        // --- Drag & Drop Event Handlers ---
        function handleDragStart(e, name, type, data) {
            draggedItem = { name, type, data };
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/plain', name);
            setTimeout(() => e.target.classList.add('dragging'), 0);
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
            draggedItem = null;
        }

        function handleDragOver(e) {
            e.preventDefault();
            const targetCell = e.target.closest('div');
            if (targetCell) {
                targetCell.classList.add('drag-over');
            }
        }

        function handleDragLeave(e) {
            const targetCell = e.target.closest('div');
            if (targetCell) {
                targetCell.classList.remove('drag-over');
            }
        }

        function handleDrop(e, targetSectionIndex, targetRowIndex, targetColIndex) {
            e.preventDefault();
            const targetCell = e.target.closest('div');
            if (targetCell) {
                targetCell.classList.remove('drag-over');
            }

            if (!draggedItem) return;

            // The name to be placed in the target cell
            const newName = draggedItem.name === 'Remove' ? '' : draggedItem.name;

            // If the item came from another roster cell, clear its original position
            if (draggedItem.type === 'cell') {
                const origin = draggedItem.data;
                rosterData.sections[origin.sectionIndex].schedule[origin.rowIndex][origin.colIndex] = '';
            }
            
            // Place the new name in the target cell
            rosterData.sections[targetSectionIndex].schedule[targetRowIndex][targetColIndex] = newName;

            // Re-render the entire UI to reflect the change
            render();
        }

        // --- Initial Load ---
        document.addEventListener('DOMContentLoaded', () => {
            datePicker.addEventListener('change', (e) => {
                rosterData.startDate = e.target.value;
                render();
            });
            render();
        });

    </script>
</body>
</html>

